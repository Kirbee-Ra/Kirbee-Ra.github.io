컨버터의 성능
=

---

## 목차
- [시스템 성능의 척도](#시스템-성능의-척도)
- [주파수 영역의 성능](#주파수-영역의-성능)
- [시간 영역 성능](#시간-영역-성능)
- [절대 안정도](#절대-안정도)
- [상대 안정도](#상대-안정도)

---

## 시스템 성능의 척도

어떤 시스템의 성능을 판단하는 척도는 여러 가지가 있습니다.
그 중에는 파워 스테이지로부터 판단할 수 있는 **정적 성능(Static Performance)**이 있고, 제어기의 설계에 따른 **동적 성능(Dynamic Performance)**이 있습니다.

### 정적 성능
정적 성능은 효율, 소자의 전압 스트레스, 소자의 전류 스트레스, 전력 밀도, 출력 리플 등으로 판단합니다.

### 동적 성능
동적 성능은 크게 다음의 세 가지로 판단합니다.
1. 주파수 영역의 성능
2. 시간 영역의 성능
3. 안정도

주파수 영역의 성능의 경우, **음파 민감도(Audio-Susceptibility)**와 **출력 임피던스(Output Impedance)**가 있습니다.
시간 영역의 성능의 경우, 부하나 입력 전압을 계단 함수 형태로 가하여 제어 성능을 판단합니다.
**안정도(Stability)**의 경우, **절대 안정도(Absolute Stability)**와 **상대 안정도(Relative Stability)**가 있습니다.

(음파 민감도의 경우, 적당한 단어를 찾기가 어려워 임의로 번역했습니다. 좋은 의견 있으면 피드백 바랍니다.)

---

## 주파수 영역의 성능

다음 컨버터의 블록 다이어그램을 살펴봅시다.

(BD)

이 시스템에서 설계해야 하는 부분이 어디인지 살펴봅시다.
먼저 파워 스테이지를 설계했다면, 개루프 전달 함수는 수정할 수 없습니다.
개루프 전달 함수는 모두 파워 스테이지의 변수들로 구성됐기 때문입니다.
PWM 블록의 경우, 기준 신호의 최댓값에만 의존합니다.
따라서 이 또한 수정할 수 없습니다.
남은 것은 전압 피드백 보상기입니다.
전압 피드백 보상기는 이전에 다뤘듯이 몇 가지 조건에 따라 우리가 임의로 설계할 수 있습니다.
이제 이를 통해 전체 시스템을 어떻게 설계해야 하는지 설명하겠습니다.

### 루프 이득

(BD)

블록 다이어그램을 살펴보면 루프 이득은 다음과 같음을 알 수 있습니다.

$$
T_m(s)=-\left(-F_v(s)\right)F_mG_{vd}(s)=F_v(s)F_mG_{vd}(s)
$$

이제 이 루프 이득을 통해 다른 전달 함수들을 구해보겠습니다.

### 음파 민감도

컨버터에서 음파 민감도는 다음과 같이 정의됩니다.

$$
		A_u(s)=\frac{\hat{v}_o(s)}{\hat{v}_{in}(s)}\Big\vert_{CL}
$$

개루프 입력-출력 전달 함수와 비슷해 보이지만, 음파 민감도는 폐루프에 대한 식입니다.
이전과 같이 관심 있는 변수인 $$\hat{v}_{in},\hat{v}_o$$를 제외한 다른 변수들의 변화는 무시하면 다음과 같이 쓸 수 있습니다.

$$
A_u(s)=\frac{G_{vs}(s)}{1+T_m(s)}
$$

과거에 쓰이던 컨버터는 스위칭 주파수가 음파의 대역에 포함되어 있었습니다.
그래서 인덕터나 변압기 등의 자기적 소자가 스위칭 주파수에 따라 진동하면 그 음파가 출력에 영향을 미쳤습니다.
현대에 쓰이는 컨버터는 스위칭 주파수가 음파의 대역과 겹치지 않습니다.
하지만 입력 전원이 $$60\ \text{Hz}$$의 교류로, 정류 회로를 거치면 $$120\ \text{Hz}$$의 리플을 갖는 입력 전압이 파워 스테이지로 들어가서 동작에 영향을 미칩니다.
그리고 다른 경로를 통해 파워 스테이지로 입력되는 노이즈 또한 컨버터의 동작에 영향을 미칩니다.
음파 민감도는 이러한 외부 노이즈들이 출력에 얼마나 영향을 미치는지를 나타냅니다.
루프 이득을 조절하여 음파 민감도를 변화시킬 수 있습니다.
음파 민감도를 모든 주파수 대역에 대해 최소화하는 것이 루프 이득의 설계 목표 중 하나입니다.

### 출력 임피던스

컨버터에서 출력 임피던스는 다음과 같이 정의됩니다.

$$
		Z_o(s)=\frac{\hat{v}_o(s)}{\hat{i}_o(s)}\Big\vert_{CL}
$$

개루프 출력 임피던스 전달 함수와 비슷해 보이지만, 출력 임피던스는 폐루프에 대한 식입니다.
이전과 같이 관심 있는 변수인 $$\hat{v}_o,\hat{i}_o$$를 제외한 다른 변수들의 변화는 무시하면 다음과 같이 쓸 수 있습니다.

$$
Z_o(s)=\frac{Z_p(s)}{1+T_m(s)}
$$

부하 전류가 외부의 영향 등으로 인해 변동되어도 컨버터는 일정한 출력을 내야 합니다.
부하 전류의 변동에 따라 출력 전압이 얼마나 변동되는지를 나타내는 지표가 바로 출력 임피던스입니다.
이 또한 루프 이득을 조절하여 변화시킬 수 있습니다.
음파 민감도와 마찬가지로 모든 주파수 대역에 대해 최소화하는 것이 루프 이득의 설계 목표 중 하나입니다.

---

## 시간 영역 성능

시간 영역 성능은 앞서 언급한 바와 같이 입력 전압이나 부하 전류의 변동에 따라 출력 전압이 얼마나 제어되는지 보는 것입니다.

### 계단 함수 부하 변동

다음과 같이 순간적으로 부하가 줄어드는 경우를 생각해봅시다.

(step load)

이때, 순간적으로 출력 전압에 오버슛이 발생합니다.
정상 상태에서 일정한 전력이 출력되는 상황을 생각해봅시다.
순간적으로 부하를 낮추면, 이미 출력단으로 넘어온 전력은 변하지 않으므로 전압에 오버슛이 발생합니다.
이 오버슛된 전압이 피드백 회로에 입력이 됩니다.
그 이후에 듀티 비가 조정되면서 출력 전압이 제어됩니다.
부하가 순간적으로 높아지는 경우는 같은 이유로 출력 전압에 언더슛이 발생합니다.
마찬가지로 이후에 피드백을 통해 전압이 제어됩니다.

이제 출력 전압 변동을 정량적으로 분석해봅시다.
출력 전압은 다음과 같이 쓸 수 있습니다.

$$
	\hat{v}_o(s)=\hat{i}_o(s)\frac{\hat{v}_o(s)}{\hat{i}_o(s)}
$$

부하 전류는 계단 함수 형태이므로 다음과 같습니다.

$$
\begin{align*}
		&\hat{i}_o(t)=I_{step}u(t)\\
		&\rightarrow \hat{i}_o(s)=\frac{I_{step}}{s}
	\end{align*}
$$

부하 전류와 출력 전압의 비는 출력 임피던스입니다.

$$
\frac{\hat{v}_o(s)}{\hat{i}_o(s)}=Z_o(s)
$$

따라서 출력 전압 변동은 다음과 같습니다.

$$
\hat{v}_o(s)=\frac{I_{step}}{s}Z_o(s)
$$

이 식에 라플라스 역변환을 취하면 시간 영역의 출력 전압을 얻을 수 있습니다.

$$
\hat{v}_o(t)=\mathscr{L}^{-1}\left[\frac{I_{step}}{s}Z_o(s)\right]
$$

출력 전압이 진동하지 않고, 빠르게 감쇠되도록 제어기를 설계해야 합니다.

### 계단 함수 입력 변동

다음과 같이 순간적으로 입력이 줄어드는 경우를 생각해봅시다.

(in step)

이때, 순간적으로 출력 전압에 언더슛이 발생합니다.
두 변수는 다른 변수들이 고정된 상태에서 비례 관계이므로 당연한 결과입니다.
이후에 언더슛된 전압이 피드백 회로에 입력이 됩니다.
그 이후에 듀티 비가 조정되면서 출력 전압이 제어됩니다.
입력 전압이 순간적으로 높아지는 경우는 같은 이유로 출력 전압에 오버슛이 발생합니다.
마찬가지로 이후에 피드백을 통해 전압이 제어됩니다.

이제 출력 전압 변동을 정량적으로 분석해봅시다.
출력 전압은 다음과 같이 쓸 수 있습니다.

$$
	\hat{v}_o(s)=\hat{v}_{in}(s)\frac{\hat{v}_o(s)}{\hat{v}_{in}(s)}
$$

부하 전류는 계단 함수 형태이므로 다음과 같습니다.

$$
\begin{align*}
		&\hat{v}_{in}(t)=V_{step}u(t)\\
		&\rightarrow \hat{v}_{in}(s)=\frac{V_{step}}{s}
	\end{align*}
$$

입력 전압와 출력 전압의 비는 음파 민감도입니다.

$$
\frac{\hat{v}_o(s)}{\hat{v}_{in}(s)}=A_u(s)
$$

따라서 출력 전압은 다음과 같습니다.

$$
\hat{v}_o(s)=\frac{I_{step}}{s}A_u(s)
$$

이 식에 라플라스 역변환을 취하면 시간 영역의 출력 전압을 얻을 수 있습니다.

$$
\hat{v}_o(t)=\mathscr{L}^{-1}\left[\frac{I_{step}}{s}A_u(s)\right]
$$

출력 전압이 진동하지 않고, 빠르게 감쇠되도록 제어기를 설계해야 합니다.

---

## 절대 안정도

컨버터의 안정도는 출력 전압을 측정하면 확인할 수 있습니다.
그림과 같이 발산하는 컨버터는 불안정한 상태입니다.
에너지 보존 법칙에 따라 유한한 입력에 대해 무한한 출력이 발생할 수 없습니다.
이렇게 발산하는 출력을 갖는 컨버터는 무한한 입력을 가지므로 큰 문제가 발생합니다.
이렇게 외란이 없는 경우에 대해 측정한 안정도를 **절대 안정도(Absolute Stability)**라고 합니다.

### 안정 조건

LTI 시스템은 모든 극점이 좌반면에 위치할 때만 안정합니다.

### 소신호 모델 분석을 통한 안정도 판별

평균화 모델은 외란이나 내란의 정도와 상관 없이 동적 성능을 보장합니다.
하지만 선형 시스템이 아니므로 선형 제어론을 이용할 수 없습니다.
소신호 모델은 외란이 너무 크지 않은 경우에는 동적 성능을 보장합니다.
이는 LTI 시스템이므로 선형 제어론을 이용할 수 있습니다.
소신호 모델로부터 정의된 안정도를 **국소 안정도(Local Stability)** 혹은 **소신호 안정도(Small-Signal Stability)**라고 합니다.

### [나이퀴스트 안정도 판별]

어떤 전달 함수가 우반면에 극점을 가진다고 해봅시다.
그 극점을 둘러싸는 경로를 전달 함수의 복소 평면에 사상하면 원점을 둘러싸는 경로를 얻을 수 있습니다.
나이퀴스트 안정도 판별법은 이러한 성질을 이용합니다.
이전에 살펴본 컨버터의 전달 함수는 다음과 같은 형태입니다.

$$
F(s)=\frac{G(s)}{1+T(s)}
$$

이 전달 함수의 극점은 다음 특성 방정식의 해입니다.

$$
1+T(s)=0
$$

$$F(s)$$가 우반면에 극점을 가지고 있고, 우반면 전체를 둘러싸는 경로를 전달 함수의 복소 평면에 사상했다고 해봅시다.
그렇다면 분모에 있는 $$+1$$의 영향으로 인해 사상된 경로는 $$(-1,0)$$을 둘러쌀 것입니다.
즉, 사상된 경로가 $$(-1,0)$$을 둘러싸면 시스템이 불안정하다는 의미입니다.
만약 사상된 경로가 $$(-1,0)$$을 둘러싸지 않는다면 시스템이 불안정하지는 않다는 의미입니다.
안정하다고 단정짓지 못하는 이유는 조건에 따라 어느 정도로 안정한지가 다르기 때문입니다.

### 안정 상태

먼저 **안정(Stable)** 상태에 대해 설명하겠습니다.
나이퀴스트 선도에서 궤적이 $$(-1,0)$$을 둘러싸지 않으면서 충분히 떨어져 있다면, 시스템은 안정 상태입니다.
즉, 위상이 $$-180^{\circ}$$일 때, 크기가 $$1$$보다 작다는 의미입니다.

### 불안정 상태

다음으로 **불안정(Unstable)** 상태입니다.
안정 상태와는 반대로, 나이퀴스트 선도의 궤적이 $$(-1,0)$$을 둘러싼다면, 이 시스템은 불안정 상태입니다.
즉, 위상이 $$-180^{\circ}$$일 때, 크기가 $$1$$보다 크다는 의미입니다.

### 임계 안정 상태

**임계 안정(Marginally Stable)** 상태는 나이퀴스트 선도의 궤적이 $$(-1,0)$$을 지나는 경우입니다.
이런 경우는 출력이 일정하게 진동하므로 제어할 수 없습니다.
그리고 약간의 외란만 가해져도 시스템이 불안정해집니다.

### 조건 안정 상태

**조건 안정(Conditionally Stable)** 상태는 안정 상태와 비슷하게 나이퀴스트 선도에서 궤적이 $$(-1,0)$$을 둘러싸지는 않습니다.
하지만 위상이 $$-180^{\circ}$$일 때, 궤적이 $$(-1,0)$$과 가깝습니다.
그래서 약간의 외란만 가해져도 시스템이 불안정해집니다.
또는 동작점이 변할 때, 루프 이득의 크기가 변하는 경우가 있습니다.
일반적인 증폭기의 경우, 포화 영역 근처에서 동작을 하게 되면 증폭 비가 줄어듭니다.
이런 경우는 루프 이득의 크기가 줄어들어서, 나이퀴스트 선도의 궤적이 $$(-1,0)$$을 지나거나 감싸게 됩니다.
이는 불안정한 시스템으로 이어집니다.

---

## 상대 안정도

다음과 같이 외란에 의해 시스템의 나이퀴스트 선도의 궤적이 조금 이동했다고 해봅시다.
이 시스템은 안정 상태였으나, 외란에 의해 불안정해졌습니다.
이처럼 외란으로부터 시스템이 얼마나 안정한지 측정한 안정도를 **상대 안정도(Relative Stability)**라고 합니다.
두 가지의 척도를 가지고 판단합니다.

### 이득 여유

첫째로 **이득 여유(Gain Margin)**입니다.
위상이 $$-180^{\circ}$$인 지점에서 궤적이 $$(-1,0)$$으로부터 떨어진 거리입니다.
궤적이 $$(-k,0)$$를 지난다면 다음과 같이 쓸 수 있습니다.

$$
\begin{align*}
\left(\text{GM}\right)&=20\log\left|-1\right|-20\log\left|-k\right|\\
&=20\log\left(\frac{1}{k}\right)
\end{align*}
$$

또한 보드 선도에서는 다음과 같이 나타납니다.

(BP)

### 위상 여유

두번째는 **위상 여유(Phase Margin)**입니다.
전달 함수의 크기가 $$1$$일 때, $$-180^{\circ}$$인 지점으로부터 떨어진 각거리입니다.
다음과 같이 쓸 수 있습니다.

$$
\begin{align*}
\left(\text{PM}\right)&=\angle\left|F(j\omega_c)\right|-(-180^{\circ})\\
&=\angle\left|F(j\omega_c)\right|+180^{\circ}
\end{align*}
$$

### 과도 상태에서의 궤적의 이동

외란에 의해 궤적이 순간적으로 이동하는 경우에도 안정 상태를 유지해야 합니다.
이득 여유와 위상 여유는 모두 불안정한 지점인 $$(-1,0)$$으로부터의 상대적인 거리를 나타내는 지표입니다.
두 지표가 충분해야 시스템이 외란으로부터 영향을 받아도 안정합니다.
그래서 이득 여유와 위상 여유를 설정하는 기준이 있습니다.

1. 이득 여유는 $$6\ \text{dB}$$를 넘도록 설계하는 것이 좋습니다.
2. 위상 여유는 $$60^{\circ}$$ 정도가 가장 좋지만, 보통 $$45^{\circ}$$만 넘도록 설계합니다. 그리고 $$30^{\circ}$$ 아래로는 떨어지지 않는 것이 좋습니다.
