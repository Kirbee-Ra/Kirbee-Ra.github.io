# 평균화 모델

---

## 평균화
선형 제어론을 통해 컨버터의 제어기를 설계하려면 컨버터를 LTI 시스템으로 바꿔야합니다.
그 첫번째 과정인 **평균화(Averaging)**에 대해 설명하겠습니다.
평균화는 스위칭 주기에 대해 컨버터의 동작(회로의 상태, 스위칭)의 평균을 낸다는 의미입니다.
즉, 시간 의존성을 없애고 시불변 시스템으로 바꾸는 과정입니다.
다음 파형을 살펴봅시다.

(switching sawtooth)

스위칭으로 인해 톱니 파형이 나타나는 것을 볼 수 있습니다.
매 시각마다 평균을 구하면 매끄러운 하나의 곡선으로 바뀝니다.

---

## 모델링 과정
컨버터를 살펴보면 스위치가 켜진 시간(온-타임)과 꺼진 시간(오프-타임)에서의 회로가 다릅니다.
먼저 각각의 회로에 대해 상태 공간 표현식을 구합니다.
그 후에 스위칭 함수를 통해 하나의 식으로 표현합니다.
이를 **스위칭 상태 공간 모델(Switched State-Space Model)**이라고 합니다.
다음으로 **회로 평균화(Circuit Averaging)**를 해줍니다.
이 과정에서 스위칭 함수를 평균화하여 듀티 비가 연속 함수로 바뀝니다.
이 과정을 거치면 **평균화 상태 공간 모델(Averaged State-Space Model)**을 얻을 수 있습니다.

---

## 스위칭 상태 공간 모델
먼제 온-타임과 오프-타임에서의 상태 공간 표현식을 구해야 합니다.
일반적인 상태 공간 표현식은 다음의 형태입니다.

$$
		\begin{cases}
			\dot{\mathbf{x}}(t)=\mathbf{A}\mathbf{x}(t)+\mathbf{B}v_{in}(t)\\
			v_o(t)=\mathbf{C}\mathbf{x}(t)+\mathbf{D}v_{in}(t)
		\end{cases}
$$

$$\mathbf{x}(t),v_{in}(t),v_o(t)$$는 각각 상태 벡터, 입력 전압, 출력 전압입니다.
$$\mathbf{A},\mathbf{B},\mathbf{C},\mathbf{D}$$는 각각 상태 행렬, 입력 행렬, 출력 행렬, 피드포워드 행렬입니다.
하지만 컨버터에는 입력 신호가 출력단으로 직접적으로 전달되는 경로가 없습니다. 따라서 $$\mathbf{D}$$는 $$\mathbf{0}$$입니다.
그러므로 컨버터의 상태 공간 표현식은 다음과 같습니다.

$$
		\begin{cases}
			\dot{\mathbf{x}}(t)=\mathbf{A}\mathbf{x}(t)+\mathbf{B}v_{in}(t)\\
			v_o(t)=\mathbf{C}\mathbf{x}(t)
		\end{cases}
$$

여기서 상태 변수로는 주로 인덕터 전류와 축전기 전압이 이용됩니다.
인덕터의 전압은 인덕터 전류의 시간 미분을 통해 구할 수 있고, 축전기 전류는 축전기 전압의 시간 미분을 통해 구할 수 있습니다.
두 변수의 시간 미분이 컨버터의 상태를 표현하는데 이용되므로, 두 변수가 주로 이용됩니다.

### 온-타임 상태 공간 표현식
온-타임에서 상태 공간 표현식은 다음과 같습니다.

$$
		\begin{cases}
			\dot{\mathbf{x}}(t)=\mathbf{A}_{on}\mathbf{x}(t)+\mathbf{B}_{on}v_{in}(t)\\
			v_o(t)=\mathbf{C}_{on}\mathbf{x}(t)
		\end{cases}
$$

$$on$$은 온-타임을 의미합니다.

### 오프-타임 상태 공간 표현식
오프-타임에서의 상태 공간 표현식은 다음과 같습니다.

$$
		\begin{cases}
			\dot{\mathbf{x}}(t)=\mathbf{A}_{off}\mathbf{x}(t)+\mathbf{B}_{off}v_{in}(t)\\
			v_o(t)=\mathbf{C}_{off}\mathbf{x}(t)
		\end{cases}
$$

$$off$$는 오프-타임을 의미합니다.
