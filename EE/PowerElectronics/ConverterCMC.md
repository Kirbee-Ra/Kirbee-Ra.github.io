컨버터의 전류 모드 제어
=

---

## 목차

---

## 컨버터의 전류 모드 제어

**전류 모드 제어(Current Mode Control, CMC)**는 출력 전압 및 인덕터 전류 정보를 바탕으로 피드백을 하여 출력 전압을 제어하는 기법입니다.
전류를 감지하는 방법 및 감지된 전류를 활용하는 법에는 여러 가지가 있습니다.
그 중 하나는 **피크 전류 모드 제어(Peak Current Mode Control)**입니다.
이는 인덕터 전류의 피크 값을 제어 변수로 활용하는 제어 기법입니다.
이는 주로 DC-DC 컨버터에 활용됩니다.
또 하나는 **평균 전류 모드 제어(Average Current Mode Control)**입니다.
이는 인덕터 전류의 평균 값을 제어 변수로 활용하는 제어 기법입니다.
이는 주로 역률 개선 회로에 활용됩니다.

---

## 피크 전류 모드 제어

[전압 모드 제어](./ConverterVMC.md)를 활용한 벅 컨버터는 다음과 같습니다.

(VMC)

제어 메커니즘을 다시 떠올려 봅시다.
잘 설계된 제어 회로의 경우, 정상 상태에서 $$Z_1$$의 크기가 유한하고, $$Z_2$$가 발산합니다.
이 조건 하에서 출력 전압에 변동이 생겼다고 해봅시다.
변동된 전압이 제어 회로에 음성 피드백으로 입력됩니다.
이는 제어 전압을 변동시킵니다.
제어 전압이 기준 신호보다 클 때, PWM의 출력이 $$1$$이 됩니다.
이 시간(온 타임) 동안만 스위치가 켜집니다.
온 타임, 즉 듀티 비를 조절하면서 출력 전압이 제어됩니다.

이제 피크 전류 모드 제어를 활용한 벅 컨버터를 살펴봅시다.

(CMC)

전압 모드 제어 회로에 인덕터 전류 감지 회로가 추가되었고, 이 신호가 PWM 비교기의 $$(-)$$단자에 연결되었습니다.
기존의 PWM의 기준 신호로 톱니파가 활용되었습니다.
톱니파가 아니더라도 동일한 결과를 얻을 수 있는 선형적인 신호는 모두 활용이 가능합니다.
대표적으로 삼각파가 있습니다.
삼각파도 PWM의 기준 신호로 많이 활용됩니다.
그리고 이 삼각파는 인덕터 전류로부터 추출할 수 있습니다.
인덕터 전류가 삼각파이기 때문입니다.
그래서 PWM의 기준 신호로 인덕터 전류 정보를 활용하는 것이 전류 모드 제어의 기본적인 아이디어입니다.

피크 전류 모드 제어에서의 제어 메커니즘을 설명하겠습니다.
전압 모드 제어의 경우, 제어 전압이 기준 신호보다 큰 경우에만 PWM의 출력이 $$1$$이었습니다.
하지만 이제는 인덕터 전류를 기준 신호로 활용합니다.
인덕터 전류는 인덕터 전압이 양의 상수인 경우에 선형적으로 증가하고, 음의 상수인 경우에 선형적으로 감소합니다.
인덕터 전압이 양수라는 것은 스위치가 켜져서 인덕터에 입력 전압과 출력 전압의 차만큼 걸린다는 의미입니다.
즉, 스위치가 켜진 시간입니다.
인덕터 전압이 음수라는 것은 스위치가 꺼져서 인덕터에 출력 전압이 극성이 반대가 되어 걸린다는 의미입니다.
즉, 스위치가 꺼진 시간입니다.
따라서 인덕터 전류가 최대가 되는 시각에 스위치를 끄면 됩니다.
이는 제어 전압과 인덕터 전류의 피크 값을 동일하게 설정하면 됩니다.
하지만 두 양은 차원이 다릅니다.
따라서 전류 감지 회로를 통해 전류 정보를 전압 차원으로 바꿔야 합니다.
그리고 피크 전류 모드 제어의 PWM 블록에는 스위치를 키기 위한 추가적인 클럭 신호가 필요합니다.
클럭 신호가 $$1$$일 때 스위치가 켜지고, 인덕터 전류가 피크 값이 될 때 스위치가 꺼집니다.
따라서 피크 전류 모드 제어의 PWM 출력 신호는 다음과 같습니다.

$$
q(t)=\begin{cases}
	1\ \ \ \text{(CLK on)}\\
	0\ \ \ \left(i_L(t)=i_{L,peak}\right)
\end{cases}
$$

### 저조파 진동

인덕터 전류의 피크 값을 감지하여 제어하는 방법은 아이디어가 좋았으나, 치명적인 문제가 있습니다.
외란에 의해 피드백 신호가 변하는 경우에 문제가 발생합니다.
우선 다음의 두 경우에 대해 살펴봅시다.
먼저 듀티 비가 $$0.5$$보다 작은 경우입니다.

(<0.5 waveform)

실선은 원래의 전류 피드백 신호이고, 점선은 외란에 의해 변화된 피드백 신호입니다.
두 신호는 이전에 언급한 PWM 메커니즘에 따라 클럭 신호가 입력될 때 증가하고, 피크 값에 도달할 때, 감소합니다.
이에 따라 두 신호를 그려보면 간격이 줄어들면서 결국 격차가 사라집니다.
즉, 컨버터가 안정된 상태입니다.
하지만 듀티 비가 $$0.5$$보다 큰 경우는 달라집니다.

(>0.5 waveform)

두 신호를 그려보면 시간이 지날 수록 간격이 더 벌어집니다.
오차가 점점 커진다는 의미이고, 이로 인해 컨버터가 불안정해집니다.
이러한 현상을 **저조파 진동(Subharmonic Oscillation)**이라고 합니다.

### 보상 신호

앞서 언급한 저조파 진동으로 인해 듀티 비가 $$0.5$$보다 큰 경우에는 피크 전류 모드 제어를 이용한 컨버터가 불안정해집니다.
그렇다고 듀티 비를 항상 $$0.5$$보다 작게 설정하여 사용할 수는 없습니다.
따라서 이를 해결할 방법이 필요합니다.
전압 모드 제어에서 사용한 기준 신호 전류 모드 제어
=

---

## 목차

---

## 컨버터의 전류 모드 제어

**전류 모드 제어(Current Mode Control, CMC)**는 출력 전압 및 인덕터 전류 정보를 바탕으로 피드백을 하여 출력 전압을 제어하는 기법입니다.
전류를 감지하는 방법 및 감지된 전류를 활용하는 법에는 여러 가지가 있습니다.
그 중 하나는 **피크 전류 모드 제어(Peak Current Mode Control)**입니다.
이는 인덕터 전류의 피크 값을 제어 변수로 활용하는 제어 기법입니다.
이는 주로 DC-DC 컨버터에 활용됩니다.
또 하나는 **평균 전류 모드 제어(Average Current Mode Control)**입니다.
이는 인덕터 전류의 평균 값을 제어 변수로 활용하는 제어 기법입니다.
이는 주로 역률 개선 회로에 활용됩니다.

---

## 피크 전류 모드 제어

[전압 모드 제어](./ConverterVMC.md)를 활용한 벅 컨버터는 다음과 같습니다.

(VMC)

제어 메커니즘을 다시 떠올려 봅시다.
잘 설계된 제어 회로의 경우, 정상 상태에서 $$Z_1$$의 크기가 유한하고, $$Z_2$$가 발산합니다.
이 조건 하에서 출력 전압에 변동이 생겼다고 해봅시다.
변동된 전압이 제어 회로에 음성 피드백으로 입력됩니다.
이는 제어 전압을 변동시킵니다.
제어 전압이 기준 신호보다 클 때, PWM의 출력이 $$1$$이 됩니다.
이 시간(온 타임) 동안만 스위치가 켜집니다.
온 타임, 즉 듀티 비를 조절하면서 출력 전압이 제어됩니다.

이제 피크 전류 모드 제어를 활용한 벅 컨버터를 살펴봅시다.

(CMC)

전압 모드 제어 회로에 인덕터 전류 감지 회로가 추가되었고, 이 신호가 PWM 비교기의 $$(-)$$단자에 연결되었습니다.
기존의 PWM의 기준 신호로 톱니파가 활용되었습니다.
톱니파가 아니더라도 동일한 결과를 얻을 수 있는 선형적인 신호는 모두 활용이 가능합니다.
대표적으로 삼각파가 있습니다.
삼각파도 PWM의 기준 신호로 많이 활용됩니다.
그리고 이 삼각파는 인덕터 전류로부터 추출할 수 있습니다.
인덕터 전류가 삼각파이기 때문입니다.
그래서 PWM의 기준 신호로 인덕터 전류 정보를 활용하는 것이 전류 모드 제어의 기본적인 아이디어입니다.

피크 전류 모드 제어에서의 제어 메커니즘을 설명하겠습니다.
전압 모드 제어의 경우, 제어 전압이 기준 신호보다 큰 경우에만 PWM의 출력이 $$1$$이었습니다.
하지만 이제는 인덕터 전류를 기준 신호로 활용합니다.
인덕터 전류는 인덕터 전압이 양의 상수인 경우에 선형적으로 증가하고, 음의 상수인 경우에 선형적으로 감소합니다.
인덕터 전압이 양수라는 것은 스위치가 켜져서 인덕터에 입력 전압과 출력 전압의 차만큼 걸린다는 의미입니다.
즉, 스위치가 켜진 시간입니다.
인덕터 전압이 음수라는 것은 스위치가 꺼져서 인덕터에 출력 전압이 극성이 반대가 되어 걸린다는 의미입니다.
즉, 스위치가 꺼진 시간입니다.
따라서 인덕터 전류가 최대가 되는 시각에 스위치를 끄면 됩니다.
이는 제어 전압과 인덕터 전류의 피크 값을 동일하게 설정하면 됩니다.
하지만 두 양은 차원이 다릅니다.
따라서 전류 감지 회로를 통해 전류 정보를 전압 차원으로 바꿔야 합니다.
그리고 피크 전류 모드 제어의 PWM 블록에는 스위치를 키기 위한 추가적인 클럭 신호가 필요합니다.
클럭 신호가 $$1$$일 때 스위치가 켜지고, 인덕터 전류가 피크 값이 될 때 스위치가 꺼집니다.
따라서 피크 전류 모드 제어의 PWM 출력 신호는 다음과 같습니다.

$$
q(t)=\begin{cases}
	1\ \ \ \text{(CLK on)}\\
	0\ \ \ \left(i_L(t)=i_{L,peak}\right)
\end{cases}
$$

### 저조파 진동

인덕터 전류의 피크 값을 감지하여 제어하는 방법은 아이디어가 좋았으나, 치명적인 문제가 있습니다.
외란에 의해 피드백 신호가 변하는 경우에 문제가 발생합니다.
우선 다음의 두 경우에 대해 살펴봅시다.
먼저 듀티 비가 $$0.5$$보다 작은 경우입니다.

(<0.5 waveform)

실선은 원래의 전류 피드백 신호이고, 점선은 외란에 의해 변화된 피드백 신호입니다.
두 신호는 이전에 언급한 PWM 메커니즘에 따라 클럭 신호가 입력될 때 증가하고, 피크 값에 도달할 때, 감소합니다.
이에 따라 두 신호를 그려보면 간격이 줄어들면서 결국 격차가 사라집니다.
즉, 컨버터가 안정된 상태입니다.
하지만 듀티 비가 $$0.5$$보다 큰 경우는 달라집니다.

(>0.5 waveform)

두 신호를 그려보면 시간이 지날 수록 간격이 더 벌어집니다.
오차가 점점 커진다는 의미이고, 이로 인해 컨버터가 불안정해집니다.
이러한 현상을 **저조파 진동(Subharmonic Oscillation)**이라고 합니다.

### 보상 신호

앞서 언급한 저조파 진동으로 인해 듀티 비가 $$0.5$$보다 큰 경우에는 피크 전류 모드 제어를 이용한 컨버터가 불안정해집니다.
그렇다고 듀티 비를 항상 $$0.5$$보다 작게 설정하여 사용할 수는 없습니다.
따라서 이를 해결할 방법이 필요합니다.
방법은 어렵지 않습니다.
전압 모드 제어에서 사용한 기준 신호를 다시 이용하는 것입니다.
전류 피드백 신호와 기준 신호(톱니파)를 더하면 파형이 다음과 같습니다.

(ramp wf)

이제 제어 메커니즘이 약간 바뀌었습니다.
스위치가 켜지는 타이밍은 이전과 동일하게 클럭 신호를 따릅니다.
하지만 스위치가 꺼지는 타이밍은 이전과 달리 전류 피드백 신호와 제어 전압이 같아질 때가 아닌, 전류 피드백 신호와 기준 신호의 합이 제어 전압과 같아질 때입니다.

$$
q(t)=\begin{cases}
	1\ \ \ \text{(CLK on)}\\
	0\ \ \ \left(v_I(t)+v_{ramp}(t)=v_{ctrl}(t)\right)
\end{cases}
$$

듀티 비를 $$0.5$$보다 크게 설정한 뒤 전류 피드백 신호에 외란을 가하면 다음과 같이 나타납니다.

(vi dist)

두 신호를 그려보면 이전과는 달리 간격이 점점 줄어듭니다.
컨버터가 안정된 상태입니다.
이 기준 신호를 $$보상 신호(Compensation Ramp)$$라고 합니다.
보상 신호를 더해줌으로써 컨버터는 듀티 비 범위 $$0<D<1$$ 내에서 안정적으로 동작합니다.

저조파 진동으로 인해 기준 신호를 외부가 아닌 회로 내부의 변수를 이용하려는 목적은 결국 달성하지 못했습니다.
비록 피크 전류 모드 제어가 외부 기준 신호를 필요로 하지만 이에 비해 가지는 이점이 많습니다.
이는 이후에 언급하겠습니다.

### 보상 신호의 정량적 해석

